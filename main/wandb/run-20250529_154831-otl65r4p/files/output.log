Weights & Biases 初始化成功。
--- 0. 加载原始完整数据从: sub_ratings.csv ---
完整原始数据集加载: 50 用户 (max_id+1), 50 物品 (max_id+1)。
从 'test_row.csv' 提取测试数据并更新训练集...
  测试集针对用户 ID: 49 (来自 test_row.csv)
  从 'test_row.csv' 提取了 10 个测试样本。
  更新后的 original_train_df 用于生成稀疏训练数据。
模型将基于原始数据维度初始化: 用户数=50, 物品数=50
测试数据集初始化: 10 个有效评分。
测试集创建成功，包含 10 个样本。
======= 主动学习迭代轮次: 1/3 (策略: TracInCP) =======
--- Iter 1: 准备数据 ---
  生成初始稀疏训练数据...
初始稀疏训练数据已生成: 332 个评分。
  当前训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 1: 初始化/重置模型 ---
--- Iter 1: 训练模型 ---
--- 开始训练迭代轮次 1 (共 10 epochs) ---
  Iter 1 Epoch [1/10], Avg Train Loss: 18.395366
  Iter 1 Epoch [2/10], Avg Train Loss: 18.290972
  Iter 1 Epoch [3/10], Avg Train Loss: 18.013478
  Iter 1 Epoch [4/10], Avg Train Loss: 17.304311
  Iter 1 Epoch [5/10], Avg Train Loss: 15.923951
  Iter 1 Epoch [5/10], Test Loss: 18.244596
    已保存checkpoint: checkpoints_iter\strategy_TracInCP\iter_1\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_TracInCP\iter_1\checkpoint_epoch_5_grads.pkl (包含 332 条记录)
  Iter 1 Epoch [6/10], Avg Train Loss: 13.729337
  Iter 1 Epoch [7/10], Avg Train Loss: 10.983082
  Iter 1 Epoch [8/10], Avg Train Loss: 7.979019
  Iter 1 Epoch [9/10], Avg Train Loss: 5.277949
  Iter 1 Epoch [10/10], Avg Train Loss: 3.211033
  Iter 1 Epoch [10/10], Test Loss: 5.219688
    已保存checkpoint: checkpoints_iter\strategy_TracInCP\iter_1\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_TracInCP\iter_1\checkpoint_epoch_10_grads.pkl (包含 332 条记录)
--- 训练迭代轮次 1 完成 ---
--- Iter 1: 计算 TracInCP 解耦影响值 ---
  TracInCP: 使用整个测试集 (包含 10 个样本) 作为影响目标。
  TracInCP: 正在为每个checkpoint和每个测试样本计算梯度并累加影响...
  Iter 1: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 9, 物品 38
    用户 9, 物品 49
    用户 9, 物品 22
    用户 9, 物品 18
    用户 9, 物品 40
    ...
--- Iter 1: 模拟数据采集 ---
  Iter 1: 已为 50 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 1: 迭代结束时最终测试损失: 5.219688
--- Iter 1: 生成可视化图像 ---
Iter 1 (TracInCP): 评分矩阵可视化已保存至: visualizations_iter\strategy_TracInCP\rating_matrix_iter_1_collection.png
======= 主动学习迭代轮次: 2/3 (策略: TracInCP) =======
--- Iter 2: 准备数据 ---
  将上一轮收集的 50 个评分添加到训练数据...
已添加 50 个新评分到训练数据。总评分数: 382
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 2: 初始化/重置模型 ---
--- Iter 2: 训练模型 ---
--- 开始训练迭代轮次 2 (共 10 epochs) ---
  Iter 2 Epoch [1/10], Avg Train Loss: 18.703169
  Iter 2 Epoch [2/10], Avg Train Loss: 18.496854
  Iter 2 Epoch [3/10], Avg Train Loss: 17.839938
  Iter 2 Epoch [4/10], Avg Train Loss: 16.209154
  Iter 2 Epoch [5/10], Avg Train Loss: 13.372069
  Iter 2 Epoch [5/10], Test Loss: 15.351801
    已保存checkpoint: checkpoints_iter\strategy_TracInCP\iter_2\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_TracInCP\iter_2\checkpoint_epoch_5_grads.pkl (包含 382 条记录)
  Iter 2 Epoch [6/10], Avg Train Loss: 9.686390
  Iter 2 Epoch [7/10], Avg Train Loss: 5.988464
  Iter 2 Epoch [8/10], Avg Train Loss: 3.265482
  Iter 2 Epoch [9/10], Avg Train Loss: 1.858355
  Iter 2 Epoch [10/10], Avg Train Loss: 1.240112
  Iter 2 Epoch [10/10], Test Loss: 1.996813
    已保存checkpoint: checkpoints_iter\strategy_TracInCP\iter_2\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_TracInCP\iter_2\checkpoint_epoch_10_grads.pkl (包含 382 条记录)
--- 训练迭代轮次 2 完成 ---
--- Iter 2: 计算 TracInCP 解耦影响值 ---
  TracInCP: 使用整个测试集 (包含 10 个样本) 作为影响目标。
  TracInCP: 正在为每个checkpoint和每个测试样本计算梯度并累加影响...
  Iter 2: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 42, 物品 7
    用户 42, 物品 25
    用户 42, 物品 14
    用户 42, 物品 34
    用户 42, 物品 5
    ...
--- Iter 2: 模拟数据采集 ---
  Iter 2: 已为 48 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 2: 迭代结束时最终测试损失: 1.996813
--- Iter 2: 生成可视化图像 ---
Iter 2 (TracInCP): 评分矩阵可视化已保存至: visualizations_iter\strategy_TracInCP\rating_matrix_iter_2_collection.png
======= 主动学习迭代轮次: 3/3 (策略: TracInCP) =======
--- Iter 3: 准备数据 ---
  将上一轮收集的 48 个评分添加到训练数据...
已添加 48 个新评分到训练数据。总评分数: 430
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 3: 初始化/重置模型 ---
--- Iter 3: 训练模型 ---
--- 开始训练迭代轮次 3 (共 10 epochs) ---
  Iter 3 Epoch [1/10], Avg Train Loss: 18.939177
  Iter 3 Epoch [2/10], Avg Train Loss: 18.723158
  Iter 3 Epoch [3/10], Avg Train Loss: 17.835567
  Iter 3 Epoch [4/10], Avg Train Loss: 15.492661
  Iter 3 Epoch [5/10], Avg Train Loss: 11.611295
  Iter 3 Epoch [5/10], Test Loss: 13.306668
    已保存checkpoint: checkpoints_iter\strategy_TracInCP\iter_3\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_TracInCP\iter_3\checkpoint_epoch_5_grads.pkl (包含 430 条记录)
  Iter 3 Epoch [6/10], Avg Train Loss: 7.072717
  Iter 3 Epoch [7/10], Avg Train Loss: 3.579493
  Iter 3 Epoch [8/10], Avg Train Loss: 1.834051
  Iter 3 Epoch [9/10], Avg Train Loss: 1.222906
  Iter 3 Epoch [10/10], Avg Train Loss: 0.919170
  Iter 3 Epoch [10/10], Test Loss: 1.131845
    已保存checkpoint: checkpoints_iter\strategy_TracInCP\iter_3\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_TracInCP\iter_3\checkpoint_epoch_10_grads.pkl (包含 430 条记录)
--- 训练迭代轮次 3 完成 ---
--- Iter 3: 计算 TracInCP 解耦影响值 ---
  TracInCP: 使用整个测试集 (包含 10 个样本) 作为影响目标。
  TracInCP: 正在为每个checkpoint和每个测试样本计算梯度并累加影响...
  Iter 3: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 19, 物品 15
    用户 19, 物品 28
    用户 19, 物品 35
    用户 19, 物品 17
    用户 19, 物品 42
    ...
--- Iter 3: 模拟数据采集 ---
  Iter 3: 已为 46 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 3: 迭代结束时最终测试损失: 1.131845
--- Iter 3: 生成可视化图像 ---
Iter 3 (TracInCP): 评分矩阵可视化已保存至: visualizations_iter\strategy_TracInCP\rating_matrix_iter_3_collection.png
======= 主动学习所有 3 轮迭代完成 =======