Weights & Biases 初始化成功。
--- 0. 加载原始完整数据从: sub_ratings.csv ---
完整原始数据集加载: 50 用户 (max_id+1), 50 物品 (max_id+1)。
从 'test_row.csv' 提取测试数据并更新训练集...
  测试集针对用户 ID: 49 (来自 test_row.csv)
  从 'test_row.csv' 提取了 10 个测试样本。
  更新后的 original_train_df 用于生成稀疏训练数据。
模型将基于原始数据维度初始化: 用户数=50, 物品数=50
测试数据集初始化: 10 个有效评分。
测试集创建成功，包含 10 个样本。
======= 主动学习迭代轮次: 1/8 (策略: Random) =======
--- Iter 1: 准备数据 ---
  生成初始稀疏训练数据...
初始稀疏训练数据已生成: 328 个评分。
  当前训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 1: 初始化/重置模型 ---
--- Iter 1: 训练模型 ---
--- 开始训练迭代轮次 1 (共 15 epochs) ---
  Iter 1 Epoch [1/15], Avg Train Loss: 18.342793
  Iter 1 Epoch [2/15], Avg Train Loss: 18.281179
  Iter 1 Epoch [3/15], Avg Train Loss: 18.185698
  Iter 1 Epoch [4/15], Avg Train Loss: 17.997802
  Iter 1 Epoch [5/15], Avg Train Loss: 17.671058
  Iter 1 Epoch [5/15], Test Loss: 20.259453
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_1\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_1\checkpoint_epoch_5_grads.pkl (包含 328 条记录)
  Iter 1 Epoch [6/15], Avg Train Loss: 17.149475
  Iter 1 Epoch [7/15], Avg Train Loss: 16.385596
  Iter 1 Epoch [8/15], Avg Train Loss: 15.365873
  Iter 1 Epoch [9/15], Avg Train Loss: 14.086067
  Iter 1 Epoch [10/15], Avg Train Loss: 12.565107
  Iter 1 Epoch [10/15], Test Loss: 15.726230
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_1\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_1\checkpoint_epoch_10_grads.pkl (包含 328 条记录)
  Iter 1 Epoch [11/15], Avg Train Loss: 10.876447
  Iter 1 Epoch [12/15], Avg Train Loss: 9.068460
  Iter 1 Epoch [13/15], Avg Train Loss: 7.264127
  Iter 1 Epoch [14/15], Avg Train Loss: 5.586018
  Iter 1 Epoch [15/15], Avg Train Loss: 4.116937
  Iter 1 Epoch [15/15], Test Loss: 6.983258
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_1\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_1\checkpoint_epoch_15_grads.pkl (包含 328 条记录)
--- 训练迭代轮次 1 完成 ---
--- Iter 1: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 1: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 7, 物品 9
    用户 40, 物品 10
    用户 43, 物品 27
    用户 38, 物品 4
    用户 24, 物品 24
    ...
--- Iter 1: 模拟数据采集 ---
  Iter 1: 已为 41 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 1: 迭代结束时最终测试损失: 6.983258
--- Iter 1: 生成可视化图像 ---
Iter 1 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_1_collection.png
======= 主动学习迭代轮次: 2/8 (策略: Random) =======
--- Iter 2: 准备数据 ---
  将上一轮收集的 41 个评分添加到训练数据...
已添加 41 个新评分到训练数据。总评分数: 369
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 2: 初始化/重置模型 ---
--- Iter 2: 训练模型 ---
--- 开始训练迭代轮次 2 (共 15 epochs) ---
  Iter 2 Epoch [1/15], Avg Train Loss: 18.184822
  Iter 2 Epoch [2/15], Avg Train Loss: 18.110803
  Iter 2 Epoch [3/15], Avg Train Loss: 17.981634
  Iter 2 Epoch [4/15], Avg Train Loss: 17.724135
  Iter 2 Epoch [5/15], Avg Train Loss: 17.236574
  Iter 2 Epoch [5/15], Test Loss: 19.899647
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_2\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_2\checkpoint_epoch_5_grads.pkl (包含 369 条记录)
  Iter 2 Epoch [6/15], Avg Train Loss: 16.473153
  Iter 2 Epoch [7/15], Avg Train Loss: 15.360709
  Iter 2 Epoch [8/15], Avg Train Loss: 13.894358
  Iter 2 Epoch [9/15], Avg Train Loss: 12.121751
  Iter 2 Epoch [10/15], Avg Train Loss: 10.111549
  Iter 2 Epoch [10/15], Test Loss: 12.759131
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_2\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_2\checkpoint_epoch_10_grads.pkl (包含 369 条记录)
  Iter 2 Epoch [11/15], Avg Train Loss: 8.019838
  Iter 2 Epoch [12/15], Avg Train Loss: 6.000816
  Iter 2 Epoch [13/15], Avg Train Loss: 4.290989
  Iter 2 Epoch [14/15], Avg Train Loss: 2.927761
  Iter 2 Epoch [15/15], Avg Train Loss: 1.999056
  Iter 2 Epoch [15/15], Test Loss: 3.623065
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_2\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_2\checkpoint_epoch_15_grads.pkl (包含 369 条记录)
--- 训练迭代轮次 2 完成 ---
--- Iter 2: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 2: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 4, 物品 45
    用户 40, 物品 3
    用户 2, 物品 21
    用户 4, 物品 32
    用户 15, 物品 17
    ...
--- Iter 2: 模拟数据采集 ---
  Iter 2: 已为 45 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 2: 迭代结束时最终测试损失: 3.623065
--- Iter 2: 生成可视化图像 ---
Iter 2 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_2_collection.png
======= 主动学习迭代轮次: 3/8 (策略: Random) =======
--- Iter 3: 准备数据 ---
  将上一轮收集的 45 个评分添加到训练数据...
已添加 45 个新评分到训练数据。总评分数: 414
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 3: 初始化/重置模型 ---
--- Iter 3: 训练模型 ---
--- 开始训练迭代轮次 3 (共 15 epochs) ---
  Iter 3 Epoch [1/15], Avg Train Loss: 18.060465
  Iter 3 Epoch [2/15], Avg Train Loss: 17.993462
  Iter 3 Epoch [3/15], Avg Train Loss: 17.871304
  Iter 3 Epoch [4/15], Avg Train Loss: 17.607789
  Iter 3 Epoch [5/15], Avg Train Loss: 17.094496
  Iter 3 Epoch [5/15], Test Loss: 19.945843
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_3\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_3\checkpoint_epoch_5_grads.pkl (包含 414 条记录)
  Iter 3 Epoch [6/15], Avg Train Loss: 16.227768
  Iter 3 Epoch [7/15], Avg Train Loss: 14.922418
  Iter 3 Epoch [8/15], Avg Train Loss: 13.217378
  Iter 3 Epoch [9/15], Avg Train Loss: 11.133430
  Iter 3 Epoch [10/15], Avg Train Loss: 8.872232
  Iter 3 Epoch [10/15], Test Loss: 12.173561
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_3\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_3\checkpoint_epoch_10_grads.pkl (包含 414 条记录)
  Iter 3 Epoch [11/15], Avg Train Loss: 6.630971
  Iter 3 Epoch [12/15], Avg Train Loss: 4.629847
  Iter 3 Epoch [13/15], Avg Train Loss: 3.038200
  Iter 3 Epoch [14/15], Avg Train Loss: 1.972603
  Iter 3 Epoch [15/15], Avg Train Loss: 1.344757
  Iter 3 Epoch [15/15], Test Loss: 2.668281
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_3\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_3\checkpoint_epoch_15_grads.pkl (包含 414 条记录)
--- 训练迭代轮次 3 完成 ---
--- Iter 3: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 3: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 43, 物品 15
    用户 36, 物品 15
    用户 37, 物品 38
    用户 2, 物品 39
    用户 5, 物品 26
    ...
--- Iter 3: 模拟数据采集 ---
  Iter 3: 已为 43 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 3: 迭代结束时最终测试损失: 2.668281
--- Iter 3: 生成可视化图像 ---
Iter 3 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_3_collection.png
======= 主动学习迭代轮次: 4/8 (策略: Random) =======
--- Iter 4: 准备数据 ---
  将上一轮收集的 43 个评分添加到训练数据...
已添加 43 个新评分到训练数据。总评分数: 457
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 4: 初始化/重置模型 ---
--- Iter 4: 训练模型 ---
--- 开始训练迭代轮次 4 (共 15 epochs) ---
  Iter 4 Epoch [1/15], Avg Train Loss: 18.012258
  Iter 4 Epoch [2/15], Avg Train Loss: 17.945268
  Iter 4 Epoch [3/15], Avg Train Loss: 17.815529
  Iter 4 Epoch [4/15], Avg Train Loss: 17.521472
  Iter 4 Epoch [5/15], Avg Train Loss: 16.941908
  Iter 4 Epoch [5/15], Test Loss: 19.946228
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_4\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_4\checkpoint_epoch_5_grads.pkl (包含 457 条记录)
  Iter 4 Epoch [6/15], Avg Train Loss: 15.950498
  Iter 4 Epoch [7/15], Avg Train Loss: 14.464066
  Iter 4 Epoch [8/15], Avg Train Loss: 12.514381
  Iter 4 Epoch [9/15], Avg Train Loss: 10.232329
  Iter 4 Epoch [10/15], Avg Train Loss: 7.800666
  Iter 4 Epoch [10/15], Test Loss: 10.525359
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_4\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_4\checkpoint_epoch_10_grads.pkl (包含 457 条记录)
  Iter 4 Epoch [11/15], Avg Train Loss: 5.513670
  Iter 4 Epoch [12/15], Avg Train Loss: 3.628991
  Iter 4 Epoch [13/15], Avg Train Loss: 2.303252
  Iter 4 Epoch [14/15], Avg Train Loss: 1.459453
  Iter 4 Epoch [15/15], Avg Train Loss: 1.001827
  Iter 4 Epoch [15/15], Test Loss: 2.189493
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_4\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_4\checkpoint_epoch_15_grads.pkl (包含 457 条记录)
--- 训练迭代轮次 4 完成 ---
--- Iter 4: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 4: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 2, 物品 22
    用户 6, 物品 22
    用户 49, 物品 35
    用户 26, 物品 39
    用户 47, 物品 9
    ...
--- Iter 4: 模拟数据采集 ---
  Iter 4: 已为 45 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 4: 迭代结束时最终测试损失: 2.189493
--- Iter 4: 生成可视化图像 ---
Iter 4 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_4_collection.png
======= 主动学习迭代轮次: 5/8 (策略: Random) =======
--- Iter 5: 准备数据 ---
  将上一轮收集的 45 个评分添加到训练数据...
已添加 45 个新评分到训练数据。总评分数: 502
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 5: 初始化/重置模型 ---
--- Iter 5: 训练模型 ---
--- 开始训练迭代轮次 5 (共 15 epochs) ---
  Iter 5 Epoch [1/15], Avg Train Loss: 18.032234
  Iter 5 Epoch [2/15], Avg Train Loss: 17.934769
  Iter 5 Epoch [3/15], Avg Train Loss: 17.690869
  Iter 5 Epoch [4/15], Avg Train Loss: 17.114052
  Iter 5 Epoch [5/15], Avg Train Loss: 15.982175
  Iter 5 Epoch [5/15], Test Loss: 17.791794
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_5\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_5\checkpoint_epoch_5_grads.pkl (包含 502 条记录)
  Iter 5 Epoch [6/15], Avg Train Loss: 14.218601
  Iter 5 Epoch [7/15], Avg Train Loss: 11.859130
  Iter 5 Epoch [8/15], Avg Train Loss: 9.153561
  Iter 5 Epoch [9/15], Avg Train Loss: 6.475206
  Iter 5 Epoch [10/15], Avg Train Loss: 4.284269
