Weights & Biases 初始化成功。
--- 0. 加载原始完整数据从: sub_ratings.csv ---
完整原始数据集加载: 50 用户 (max_id+1), 50 物品 (max_id+1)。
从 'test_row.csv' 提取测试数据并更新训练集...
  测试集针对用户 ID: 49 (来自 test_row.csv)
  从 'test_row.csv' 提取了 27 个测试样本。
  更新后的 original_train_df 用于生成稀疏训练数据。
模型将基于原始数据维度初始化: 用户数=50, 物品数=50
测试数据集初始化: 27 个有效评分。
测试集创建成功，包含 27 个样本。
======= 主动学习迭代轮次: 1/10 (策略: Random) =======
--- Iter 1: 准备数据 ---
  生成初始稀疏训练数据...
初始稀疏训练数据已生成: 327 个评分。
  当前训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 1: 初始化/重置模型 ---
--- Iter 1: 训练模型 ---
--- 开始训练迭代轮次 1 (共 15 epochs) ---
  Iter 1 Epoch [1/15], Avg Train Loss: 18.109163
  Iter 1 Epoch [2/15], Avg Train Loss: 18.041686
  Iter 1 Epoch [3/15], Avg Train Loss: 17.936931
  Iter 1 Epoch [4/15], Avg Train Loss: 17.744118
  Iter 1 Epoch [5/15], Avg Train Loss: 17.418456
  Iter 1 Epoch [5/15], Test Loss: 18.172726
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_1\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_1\checkpoint_epoch_5_grads.pkl (包含 327 条记录)
  Iter 1 Epoch [6/15], Avg Train Loss: 16.907390
  Iter 1 Epoch [7/15], Avg Train Loss: 16.182206
  Iter 1 Epoch [8/15], Avg Train Loss: 15.217043
  Iter 1 Epoch [9/15], Avg Train Loss: 13.997771
  Iter 1 Epoch [10/15], Avg Train Loss: 12.566095
  Iter 1 Epoch [10/15], Test Loss: 13.985583
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_1\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_1\checkpoint_epoch_10_grads.pkl (包含 327 条记录)
  Iter 1 Epoch [11/15], Avg Train Loss: 10.926591
  Iter 1 Epoch [12/15], Avg Train Loss: 9.204961
  Iter 1 Epoch [13/15], Avg Train Loss: 7.459925
  Iter 1 Epoch [14/15], Avg Train Loss: 5.797195
  Iter 1 Epoch [15/15], Avg Train Loss: 4.356706
  Iter 1 Epoch [15/15], Test Loss: 6.031339
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_1\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_1\checkpoint_epoch_15_grads.pkl (包含 327 条记录)
--- 训练迭代轮次 1 完成 ---
--- Iter 1: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 1: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 41, 物品 21
    用户 7, 物品 18
    用户 27, 物品 10
    用户 46, 物品 46
    用户 16, 物品 32
    ...
--- Iter 1: 模拟数据采集 ---
  Iter 1: 已为 42 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 1: 迭代结束时最终测试损失: 6.031339
--- Iter 1: 生成可视化图像 ---
Iter 1 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_1_collection.png
======= 主动学习迭代轮次: 2/10 (策略: Random) =======
--- Iter 2: 准备数据 ---
  将上一轮收集的 42 个评分添加到训练数据...
已添加 42 个新评分到训练数据。总评分数: 369
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 2: 初始化/重置模型 ---
--- Iter 2: 训练模型 ---
--- 开始训练迭代轮次 2 (共 15 epochs) ---
  Iter 2 Epoch [1/15], Avg Train Loss: 17.805899
  Iter 2 Epoch [2/15], Avg Train Loss: 17.735920
  Iter 2 Epoch [3/15], Avg Train Loss: 17.615141
  Iter 2 Epoch [4/15], Avg Train Loss: 17.379602
  Iter 2 Epoch [5/15], Avg Train Loss: 16.941890
  Iter 2 Epoch [5/15], Test Loss: 17.761160
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_2\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_2\checkpoint_epoch_5_grads.pkl (包含 369 条记录)
  Iter 2 Epoch [6/15], Avg Train Loss: 16.251693
  Iter 2 Epoch [7/15], Avg Train Loss: 15.243552
  Iter 2 Epoch [8/15], Avg Train Loss: 13.899323
  Iter 2 Epoch [9/15], Avg Train Loss: 12.242682
  Iter 2 Epoch [10/15], Avg Train Loss: 10.364900
  Iter 2 Epoch [10/15], Test Loss: 10.791917
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_2\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_2\checkpoint_epoch_10_grads.pkl (包含 369 条记录)
  Iter 2 Epoch [11/15], Avg Train Loss: 8.372632
  Iter 2 Epoch [12/15], Avg Train Loss: 6.440417
  Iter 2 Epoch [13/15], Avg Train Loss: 4.704626
  Iter 2 Epoch [14/15], Avg Train Loss: 3.304005
  Iter 2 Epoch [15/15], Avg Train Loss: 2.279907
  Iter 2 Epoch [15/15], Test Loss: 2.461851
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_2\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_2\checkpoint_epoch_15_grads.pkl (包含 369 条记录)
--- 训练迭代轮次 2 完成 ---
--- Iter 2: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 2: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 27, 物品 22
    用户 27, 物品 26
    用户 29, 物品 46
    用户 3, 物品 43
    用户 41, 物品 41
    ...
--- Iter 2: 模拟数据采集 ---
  Iter 2: 已为 43 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 2: 迭代结束时最终测试损失: 2.461851
--- Iter 2: 生成可视化图像 ---
Iter 2 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_2_collection.png
======= 主动学习迭代轮次: 3/10 (策略: Random) =======
--- Iter 3: 准备数据 ---
  将上一轮收集的 43 个评分添加到训练数据...
已添加 43 个新评分到训练数据。总评分数: 412
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 3: 初始化/重置模型 ---
--- Iter 3: 训练模型 ---
--- 开始训练迭代轮次 3 (共 15 epochs) ---
  Iter 3 Epoch [1/15], Avg Train Loss: 17.843561
  Iter 3 Epoch [2/15], Avg Train Loss: 17.778328
  Iter 3 Epoch [3/15], Avg Train Loss: 17.670914
  Iter 3 Epoch [4/15], Avg Train Loss: 17.451683
  Iter 3 Epoch [5/15], Avg Train Loss: 17.042936
  Iter 3 Epoch [5/15], Test Loss: 17.954172
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_3\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_3\checkpoint_epoch_5_grads.pkl (包含 412 条记录)
  Iter 3 Epoch [6/15], Avg Train Loss: 16.379342
  Iter 3 Epoch [7/15], Avg Train Loss: 15.388782
  Iter 3 Epoch [8/15], Avg Train Loss: 14.015637
  Iter 3 Epoch [9/15], Avg Train Loss: 12.330683
  Iter 3 Epoch [10/15], Avg Train Loss: 10.366451
  Iter 3 Epoch [10/15], Test Loss: 11.362538
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_3\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_3\checkpoint_epoch_10_grads.pkl (包含 412 条记录)
  Iter 3 Epoch [11/15], Avg Train Loss: 8.271139
  Iter 3 Epoch [12/15], Avg Train Loss: 6.227789
  Iter 3 Epoch [13/15], Avg Train Loss: 4.433436
  Iter 3 Epoch [14/15], Avg Train Loss: 3.027273
  Iter 3 Epoch [15/15], Avg Train Loss: 2.027222
  Iter 3 Epoch [15/15], Test Loss: 2.784046
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_3\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_3\checkpoint_epoch_15_grads.pkl (包含 412 条记录)
--- 训练迭代轮次 3 完成 ---
--- Iter 3: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 3: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 36, 物品 6
    用户 4, 物品 34
    用户 13, 物品 32
    用户 16, 物品 8
    用户 22, 物品 4
    ...
--- Iter 3: 模拟数据采集 ---
  Iter 3: 已为 44 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 3: 迭代结束时最终测试损失: 2.784046
--- Iter 3: 生成可视化图像 ---
Iter 3 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_3_collection.png
======= 主动学习迭代轮次: 4/10 (策略: Random) =======
--- Iter 4: 准备数据 ---
  将上一轮收集的 44 个评分添加到训练数据...
已添加 44 个新评分到训练数据。总评分数: 456
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 4: 初始化/重置模型 ---
--- Iter 4: 训练模型 ---
--- 开始训练迭代轮次 4 (共 15 epochs) ---
  Iter 4 Epoch [1/15], Avg Train Loss: 17.855218
  Iter 4 Epoch [2/15], Avg Train Loss: 17.784383
  Iter 4 Epoch [3/15], Avg Train Loss: 17.643278
  Iter 4 Epoch [4/15], Avg Train Loss: 17.322455
  Iter 4 Epoch [5/15], Avg Train Loss: 16.691664
  Iter 4 Epoch [5/15], Test Loss: 17.427763
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_4\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_4\checkpoint_epoch_5_grads.pkl (包含 456 条记录)
  Iter 4 Epoch [6/15], Avg Train Loss: 15.652914
  Iter 4 Epoch [7/15], Avg Train Loss: 14.115720
  Iter 4 Epoch [8/15], Avg Train Loss: 12.113275
  Iter 4 Epoch [9/15], Avg Train Loss: 9.837719
  Iter 4 Epoch [10/15], Avg Train Loss: 7.423775
  Iter 4 Epoch [10/15], Test Loss: 8.429542
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_4\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_4\checkpoint_epoch_10_grads.pkl (包含 456 条记录)
  Iter 4 Epoch [11/15], Avg Train Loss: 5.203744
  Iter 4 Epoch [12/15], Avg Train Loss: 3.426736
  Iter 4 Epoch [13/15], Avg Train Loss: 2.160129
  Iter 4 Epoch [14/15], Avg Train Loss: 1.408487
  Iter 4 Epoch [15/15], Avg Train Loss: 1.004293
  Iter 4 Epoch [15/15], Test Loss: 1.243563
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_4\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_4\checkpoint_epoch_15_grads.pkl (包含 456 条记录)
--- 训练迭代轮次 4 完成 ---
--- Iter 4: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 4: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 1, 物品 42
    用户 21, 物品 17
    用户 4, 物品 49
    用户 17, 物品 22
    用户 41, 物品 32
    ...
--- Iter 4: 模拟数据采集 ---
  Iter 4: 已为 44 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 4: 迭代结束时最终测试损失: 1.243563
--- Iter 4: 生成可视化图像 ---
Iter 4 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_4_collection.png
======= 主动学习迭代轮次: 5/10 (策略: Random) =======
--- Iter 5: 准备数据 ---
  将上一轮收集的 44 个评分添加到训练数据...
已添加 44 个新评分到训练数据。总评分数: 500
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 5: 初始化/重置模型 ---
--- Iter 5: 训练模型 ---
--- 开始训练迭代轮次 5 (共 15 epochs) ---
  Iter 5 Epoch [1/15], Avg Train Loss: 18.036289
  Iter 5 Epoch [2/15], Avg Train Loss: 17.951381
  Iter 5 Epoch [3/15], Avg Train Loss: 17.752914
  Iter 5 Epoch [4/15], Avg Train Loss: 17.286697
  Iter 5 Epoch [5/15], Avg Train Loss: 16.377033
  Iter 5 Epoch [5/15], Test Loss: 16.307262
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_5\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_5\checkpoint_epoch_5_grads.pkl (包含 500 条记录)
  Iter 5 Epoch [6/15], Avg Train Loss: 14.929271
  Iter 5 Epoch [7/15], Avg Train Loss: 12.865337
  Iter 5 Epoch [8/15], Avg Train Loss: 10.323053
  Iter 5 Epoch [9/15], Avg Train Loss: 7.577907
  Iter 5 Epoch [10/15], Avg Train Loss: 5.025027
  Iter 5 Epoch [10/15], Test Loss: 3.619409
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_5\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_5\checkpoint_epoch_10_grads.pkl (包含 500 条记录)
  Iter 5 Epoch [11/15], Avg Train Loss: 3.004555
  Iter 5 Epoch [12/15], Avg Train Loss: 1.705947
  Iter 5 Epoch [13/15], Avg Train Loss: 1.062607
  Iter 5 Epoch [14/15], Avg Train Loss: 0.783911
  Iter 5 Epoch [15/15], Avg Train Loss: 0.660183
  Iter 5 Epoch [15/15], Test Loss: 0.417215
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_5\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_5\checkpoint_epoch_15_grads.pkl (包含 500 条记录)
--- 训练迭代轮次 5 完成 ---
--- Iter 5: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 5: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 4, 物品 29
    用户 24, 物品 31
    用户 9, 物品 41
    用户 44, 物品 0
    用户 48, 物品 49
    ...
--- Iter 5: 模拟数据采集 ---
  Iter 5: 已为 46 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 5: 迭代结束时最终测试损失: 0.417215
--- Iter 5: 生成可视化图像 ---
Iter 5 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_5_collection.png
======= 主动学习迭代轮次: 6/10 (策略: Random) =======
--- Iter 6: 准备数据 ---
  将上一轮收集的 46 个评分添加到训练数据...
已添加 46 个新评分到训练数据。总评分数: 546
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 6: 初始化/重置模型 ---
--- Iter 6: 训练模型 ---
--- 开始训练迭代轮次 6 (共 15 epochs) ---
  Iter 6 Epoch [1/15], Avg Train Loss: 17.860983
  Iter 6 Epoch [2/15], Avg Train Loss: 17.770373
  Iter 6 Epoch [3/15], Avg Train Loss: 17.534872
  Iter 6 Epoch [4/15], Avg Train Loss: 16.936597
  Iter 6 Epoch [5/15], Avg Train Loss: 15.738025
  Iter 6 Epoch [5/15], Test Loss: 15.946604
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_6\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_6\checkpoint_epoch_5_grads.pkl (包含 546 条记录)
  Iter 6 Epoch [6/15], Avg Train Loss: 13.782095
  Iter 6 Epoch [7/15], Avg Train Loss: 11.133905
  Iter 6 Epoch [8/15], Avg Train Loss: 8.056146
  Iter 6 Epoch [9/15], Avg Train Loss: 5.157744
  Iter 6 Epoch [10/15], Avg Train Loss: 2.910634
  Iter 6 Epoch [10/15], Test Loss: 2.336418
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_6\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_6\checkpoint_epoch_10_grads.pkl (包含 546 条记录)
  Iter 6 Epoch [11/15], Avg Train Loss: 1.587578
  Iter 6 Epoch [12/15], Avg Train Loss: 0.972242
  Iter 6 Epoch [13/15], Avg Train Loss: 0.739087
  Iter 6 Epoch [14/15], Avg Train Loss: 0.644761
  Iter 6 Epoch [15/15], Avg Train Loss: 0.598343
  Iter 6 Epoch [15/15], Test Loss: 0.358671
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_6\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_6\checkpoint_epoch_15_grads.pkl (包含 546 条记录)
--- 训练迭代轮次 6 完成 ---
--- Iter 6: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 6: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 42, 物品 1
    用户 5, 物品 41
    用户 27, 物品 8
    用户 29, 物品 11
    用户 3, 物品 16
    ...
--- Iter 6: 模拟数据采集 ---
  Iter 6: 已为 46 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 6: 迭代结束时最终测试损失: 0.358671
--- Iter 6: 生成可视化图像 ---
Iter 6 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_6_collection.png
======= 主动学习迭代轮次: 7/10 (策略: Random) =======
--- Iter 7: 准备数据 ---
  将上一轮收集的 46 个评分添加到训练数据...
已添加 46 个新评分到训练数据。总评分数: 592
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 7: 初始化/重置模型 ---
--- Iter 7: 训练模型 ---
--- 开始训练迭代轮次 7 (共 15 epochs) ---
  Iter 7 Epoch [1/15], Avg Train Loss: 17.905666
  Iter 7 Epoch [2/15], Avg Train Loss: 17.803136
  Iter 7 Epoch [3/15], Avg Train Loss: 17.471349
  Iter 7 Epoch [4/15], Avg Train Loss: 16.532454
  Iter 7 Epoch [5/15], Avg Train Loss: 14.665857
  Iter 7 Epoch [5/15], Test Loss: 14.303377
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_7\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_7\checkpoint_epoch_5_grads.pkl (包含 592 条记录)
  Iter 7 Epoch [6/15], Avg Train Loss: 11.837400
  Iter 7 Epoch [7/15], Avg Train Loss: 8.436229
  Iter 7 Epoch [8/15], Avg Train Loss: 5.181699
  Iter 7 Epoch [9/15], Avg Train Loss: 2.724632
  Iter 7 Epoch [10/15], Avg Train Loss: 1.393315
  Iter 7 Epoch [10/15], Test Loss: 0.932776
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_7\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_7\checkpoint_epoch_10_grads.pkl (包含 592 条记录)
  Iter 7 Epoch [11/15], Avg Train Loss: 0.877978
  Iter 7 Epoch [12/15], Avg Train Loss: 0.704333
  Iter 7 Epoch [13/15], Avg Train Loss: 0.632495
  Iter 7 Epoch [14/15], Avg Train Loss: 0.592671
  Iter 7 Epoch [15/15], Avg Train Loss: 0.573608
  Iter 7 Epoch [15/15], Test Loss: 0.331127
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_7\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_7\checkpoint_epoch_15_grads.pkl (包含 592 条记录)
--- 训练迭代轮次 7 完成 ---
--- Iter 7: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 7: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 1, 物品 31
    用户 20, 物品 11
    用户 31, 物品 13
    用户 22, 物品 16
    用户 21, 物品 17
    ...
--- Iter 7: 模拟数据采集 ---
  Iter 7: 已为 44 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 7: 迭代结束时最终测试损失: 0.331127
--- Iter 7: 生成可视化图像 ---
Iter 7 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_7_collection.png
======= 主动学习迭代轮次: 8/10 (策略: Random) =======
--- Iter 8: 准备数据 ---
  将上一轮收集的 44 个评分添加到训练数据...
已添加 44 个新评分到训练数据。总评分数: 636
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 8: 初始化/重置模型 ---
--- Iter 8: 训练模型 ---
--- 开始训练迭代轮次 8 (共 15 epochs) ---
  Iter 8 Epoch [1/15], Avg Train Loss: 17.855851
  Iter 8 Epoch [2/15], Avg Train Loss: 17.757102
  Iter 8 Epoch [3/15], Avg Train Loss: 17.463798
  Iter 8 Epoch [4/15], Avg Train Loss: 16.658040
  Iter 8 Epoch [5/15], Avg Train Loss: 15.012206
  Iter 8 Epoch [5/15], Test Loss: 14.584783
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_8\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_8\checkpoint_epoch_5_grads.pkl (包含 636 条记录)
  Iter 8 Epoch [6/15], Avg Train Loss: 12.421045
  Iter 8 Epoch [7/15], Avg Train Loss: 9.095688
  Iter 8 Epoch [8/15], Avg Train Loss: 5.685113
  Iter 8 Epoch [9/15], Avg Train Loss: 2.996656
  Iter 8 Epoch [10/15], Avg Train Loss: 1.443001
  Iter 8 Epoch [10/15], Test Loss: 0.976864
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_8\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_8\checkpoint_epoch_10_grads.pkl (包含 636 条记录)
  Iter 8 Epoch [11/15], Avg Train Loss: 0.849610
  Iter 8 Epoch [12/15], Avg Train Loss: 0.660352
  Iter 8 Epoch [13/15], Avg Train Loss: 0.586643
  Iter 8 Epoch [14/15], Avg Train Loss: 0.553095
  Iter 8 Epoch [15/15], Avg Train Loss: 0.535822
  Iter 8 Epoch [15/15], Test Loss: 0.327005
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_8\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_8\checkpoint_epoch_15_grads.pkl (包含 636 条记录)
--- 训练迭代轮次 8 完成 ---
--- Iter 8: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 8: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 7, 物品 35
    用户 48, 物品 26
    用户 38, 物品 38
    用户 39, 物品 14
    用户 49, 物品 33
    ...
--- Iter 8: 模拟数据采集 ---
  Iter 8: 已为 43 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 8: 迭代结束时最终测试损失: 0.327005
--- Iter 8: 生成可视化图像 ---
Iter 8 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_8_collection.png
======= 主动学习迭代轮次: 9/10 (策略: Random) =======
--- Iter 9: 准备数据 ---
  将上一轮收集的 43 个评分添加到训练数据...
已添加 43 个新评分到训练数据。总评分数: 679
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 9: 初始化/重置模型 ---
--- Iter 9: 训练模型 ---
--- 开始训练迭代轮次 9 (共 15 epochs) ---
  Iter 9 Epoch [1/15], Avg Train Loss: 17.893277
  Iter 9 Epoch [2/15], Avg Train Loss: 17.773875
  Iter 9 Epoch [3/15], Avg Train Loss: 17.308064
  Iter 9 Epoch [4/15], Avg Train Loss: 15.957398
  Iter 9 Epoch [5/15], Avg Train Loss: 13.267348
  Iter 9 Epoch [5/15], Test Loss: 13.366467
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_9\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_9\checkpoint_epoch_5_grads.pkl (包含 679 条记录)
  Iter 9 Epoch [6/15], Avg Train Loss: 9.469837
  Iter 9 Epoch [7/15], Avg Train Loss: 5.505967
  Iter 9 Epoch [8/15], Avg Train Loss: 2.623147
  Iter 9 Epoch [9/15], Avg Train Loss: 1.208873
  Iter 9 Epoch [10/15], Avg Train Loss: 0.803803
  Iter 9 Epoch [10/15], Test Loss: 0.502098
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_9\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_9\checkpoint_epoch_10_grads.pkl (包含 679 条记录)
  Iter 9 Epoch [11/15], Avg Train Loss: 0.674850
  Iter 9 Epoch [12/15], Avg Train Loss: 0.619252
  Iter 9 Epoch [13/15], Avg Train Loss: 0.596587
  Iter 9 Epoch [14/15], Avg Train Loss: 0.589468
  Iter 9 Epoch [15/15], Avg Train Loss: 0.584631
  Iter 9 Epoch [15/15], Test Loss: 0.320390
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_9\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_9\checkpoint_epoch_15_grads.pkl (包含 679 条记录)
--- 训练迭代轮次 9 完成 ---
--- Iter 9: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 9: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 21, 物品 26
    用户 18, 物品 42
    用户 25, 物品 48
    用户 35, 物品 2
    用户 29, 物品 5
    ...
--- Iter 9: 模拟数据采集 ---
  Iter 9: 已为 41 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 9: 迭代结束时最终测试损失: 0.320390
--- Iter 9: 生成可视化图像 ---
Iter 9 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_9_collection.png
======= 主动学习迭代轮次: 10/10 (策略: Random) =======
--- Iter 10: 准备数据 ---
  将上一轮收集的 41 个评分添加到训练数据...
已添加 41 个新评分到训练数据。总评分数: 720
  更新后训练数据用户数 (基于0的最大ID+1): 50, 物品数 (基于0的最大ID+1): 50
--- Iter 10: 初始化/重置模型 ---
--- Iter 10: 训练模型 ---
--- 开始训练迭代轮次 10 (共 15 epochs) ---
  Iter 10 Epoch [1/15], Avg Train Loss: 17.925126
  Iter 10 Epoch [2/15], Avg Train Loss: 17.761394
  Iter 10 Epoch [3/15], Avg Train Loss: 17.215360
  Iter 10 Epoch [4/15], Avg Train Loss: 15.869059
  Iter 10 Epoch [5/15], Avg Train Loss: 13.396506
  Iter 10 Epoch [5/15], Test Loss: 12.726332
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_10\model_epoch_5.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_10\checkpoint_epoch_5_grads.pkl (包含 720 条记录)
  Iter 10 Epoch [6/15], Avg Train Loss: 9.974819
  Iter 10 Epoch [7/15], Avg Train Loss: 6.241366
  Iter 10 Epoch [8/15], Avg Train Loss: 3.202141
  Iter 10 Epoch [9/15], Avg Train Loss: 1.482876
  Iter 10 Epoch [10/15], Avg Train Loss: 0.840421
  Iter 10 Epoch [10/15], Test Loss: 0.725916
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_10\model_epoch_10.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_10\checkpoint_epoch_10_grads.pkl (包含 720 条记录)
  Iter 10 Epoch [11/15], Avg Train Loss: 0.657145
  Iter 10 Epoch [12/15], Avg Train Loss: 0.588133
  Iter 10 Epoch [13/15], Avg Train Loss: 0.550920
  Iter 10 Epoch [14/15], Avg Train Loss: 0.528582
  Iter 10 Epoch [15/15], Avg Train Loss: 0.513765
  Iter 10 Epoch [15/15], Test Loss: 0.331884
    已保存checkpoint: checkpoints_iter\strategy_Random\iter_10\model_epoch_15.pt
    已保存梯度日志: gradient_logs_iter\strategy_Random\iter_10\checkpoint_epoch_15_grads.pkl (包含 720 条记录)
--- 训练迭代轮次 10 完成 ---
--- Iter 10: 使用随机策略生成采集点 ---
  随机策略选择了 50 个采集点。
  Iter 10: 已识别出 50 个新的待采集位置 (目标: 50):
    用户 30, 物品 16
    用户 21, 物品 39
    用户 44, 物品 25
    用户 41, 物品 5
    用户 21, 物品 43
    ...
--- Iter 10: 模拟数据采集 ---
  Iter 10: 已为 43 个采集点获取了“真实”评分并准备添加到下一轮。
  Iter 10: 迭代结束时最终测试损失: 0.331884
--- Iter 10: 生成可视化图像 ---
Iter 10 (Random): 评分矩阵可视化已保存至: visualizations_iter\strategy_Random\rating_matrix_iter_10_collection.png
======= 主动学习所有 10 轮迭代完成 =======